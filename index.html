<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>アルゴリズム可視化ツール（フォワード／ビタビ強化版）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <header class="header">
    アルゴリズム可視化ツール<br>
    <span class="subtitle">フォワードアルゴリズム ＆ ビタビアルゴリズム 可視化</span>
  </header>

  <main class="container">
    <!-- 色の凡例 -->
    <section class="section legend">
      <h3 class="section-title">■ 色の凡例</h3>
      <div class="legend-items">
        <div class="legend-item">
          <div class="legend-color normal"></div>
          <span>通常セル</span>
        </div>
        <div class="legend-item">
          <div class="legend-color current"></div>
          <span>現在更新中セル</span>
        </div>
        <div class="legend-item">
          <div class="legend-color path"></div>
          <span>確定経路セル</span>
        </div>
      </div>
    </section>

    <!-- アルゴリズム選択 -->
    <section class="section controls">
      <label class="label" for="algoSelect">アルゴリズムを選択：</label>
      <select id="algoSelect" class="select">
        <option value="">-- 選択してください --</option>
        <option value="forward">Forward アルゴリズム</option>
        <option value="viterbi">Viterbi アルゴリズム</option>
      </select>
    </section>

    <!-- ================================
         5) Forward アルゴリズム
         ================================ -->
    <section id="forwardControls" class="section algo-controls" style="display:none;">
      <h2 class="section-title">Forward アルゴリズム（HMM）</h2>

      <!-- 入力フォーム -->
      <div class="controls">
        <label class="label">状態（カンマ区切り）：
          <input type="text" id="fwd_states" class="input" placeholder="例: Rainy,Sunny" />
        </label>
        <label class="label">観測系列（カンマ区切り）：
          <input type="text" id="fwd_obs" class="input" placeholder="例: walk,shop,clean" />
        </label>
        <label class="label">初期確率 π（状態順）：
          <input type="text" id="fwd_pi" class="input" placeholder="例: 0.6,0.4" />
        </label>
        <label class="label">遷移確率 A（改行とカンマ区切り）：
          <textarea id="fwd_A" class="input" rows="3"
            placeholder="例：
0.7,0.3
0.4,0.6"></textarea>
        </label>
        <label class="label">出力確率 B（改行とカンマ区切り）：
          <textarea id="fwd_B" class="input" rows="3"
            placeholder="例：
0.1,0.4,0.5
0.6,0.3,0.1"></textarea>
        </label>
      </div>

      <div class="controls">
        <button id="fwdInitBtn" class="btn">Initialize</button>
        <button id="fwdRandomBtn" class="btn">ランダム生成</button>
      </div>

      <!-- テーブル (トレリス) -->
      <div id="fwdTableWrapper" class="table-wrapper">
        <table id="fwdTable" class="trellis-table"></table>
      </div>

      <!-- 再生／ステップ操作 -->
      <div class="controls">
        <label class="label">
          Auto Play 倍率：
          <select id="fwdSpeedSelect" class="select speed-select">
            <option value="0.5">0.5×</option>
            <option value="1.0" selected>1.0×</option>
            <option value="1.5">1.5×</option>
            <option value="2.0">2.0×</option>
            <option value="3.0">3.0×</option>
          </select>
        </label>
      </div>
      <div class="step-controls">
        <button id="fwdPrevBtn" class="btn" disabled>前へ</button>
        <button id="fwdNextBtn" class="btn" disabled>次へ</button>
        <button id="fwdAutoBtn" class="btn" disabled>Auto Play</button>
      </div>
      <div id="fwdProgress" class="progress">ステップ 0 / 0</div>
      <div id="fwdDesc" class="description">
        <strong>Forward アルゴリズムとは：</strong><br>
        隠れマルコフモデル（HMM）において、観測系列が与えられたとき、その観測系列の尤度を求める手法です。<br>
        トレリス（時間×状態 の格子）で α(t,j) を計算し、ステップごとにセルを更新します。
      </div>
    </section>

    <!-- ================================
         6) Viterbi アルゴリズム
         ================================ -->
    <section id="viterbiControls" class="section algo-controls" style="display:none;">
      <h2 class="section-title">Viterbi アルゴリズム（HMM）</h2>

      <!-- 入力フォーム -->
      <div class="controls">
        <label class="label">状態（カンマ区切り）：
          <input type="text" id="vit_states" class="input" placeholder="例: Rainy,Sunny" />
        </label>
        <label class="label">観測系列（カンマ区切り）：
          <input type="text" id="vit_obs" class="input" placeholder="例: walk,shop,clean" />
        </label>
        <label class="label">初期確率 π（状態順）：
          <input type="text" id="vit_pi" class="input" placeholder="例: 0.6,0.4" />
        </label>
        <label class="label">遷移確率 A（改行とカンマ区切り）：
          <textarea id="vit_A" class="input" rows="3"
            placeholder="例：
0.7,0.3
0.4,0.6"></textarea>
        </label>
        <label class="label">出力確率 B（改行とカンマ区切り）：
          <textarea id="vit_B" class="input" rows="3"
            placeholder="例：
0.1,0.4,0.5
0.6,0.3,0.1"></textarea>
        </label>
      </div>

      <div class="controls">
        <button id="vitInitBtn" class="btn">Initialize</button>
        <button id="vitRandomBtn" class="btn">ランダム生成</button>
      </div>

      <!-- テーブル (トレリス) -->
      <div id="vitTableWrapper" class="table-wrapper">
        <table id="vitTable" class="trellis-table"></table>
      </div>

      <!-- 再生／ステップ操作 -->
      <div class="controls">
        <label class="label">
          Auto Play 倍率：
          <select id="vitSpeedSelect" class="select speed-select">
            <option value="0.5">0.5×</option>
            <option value="1.0" selected>1.0×</option>
            <option value="1.5">1.5×</option>
            <option value="2.0">2.0×</option>
            <option value="3.0">3.0×</option>
          </select>
        </label>
      </div>
      <div class="step-controls">
        <button id="vitPrevBtn" class="btn" disabled>前へ</button>
        <button id="vitNextBtn" class="btn" disabled>次へ</button>
        <button id="vitAutoBtn" class="btn" disabled>Auto Play</button>
      </div>
      <div id="vitProgress" class="progress">ステップ 0 / 0</div>
      <div id="vitDesc" class="description">
        <strong>Viterbi アルゴリズムとは：</strong><br>
        HMM において、観測系列から最尤の隠れ状態列を求める手法です。<br>
        トレリス（時間×状態 の格子）で δ(t,j) を計算し、ステップごとにセルと矢印を更新します。
      </div>
    </section>
  </main>

  <script src="js/main.js"></script>
</body>
</html>
